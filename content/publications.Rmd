---
title: Publications
menu: main
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(here)
library(glue)
library(lubridate)
library(googlesheets4)
gs4_deauth()

publications <- read_sheet("https://docs.google.com/spreadsheets/d/1ta71CAGkcLqm-W1UdVRA_JJSddWV2TsrRZsCnQlmOis/edit?usp=sharing",
           sheet = "publications",
           col_types = "c")
```

<div class="row publications-page">

<div class="col-sm-2"></div>

<div class="col-sm-10">
```{r}
# create the table data
publications_table <- publications %>%
  arrange(desc(date), type) %>%
  mutate(title = ifelse(!is.na(url), str_c("[", title, "](", url, ")"), title)) %>% #turn title into link
  mutate(award = case_when(
    award == "Best Paper"         ~ str_c("<i class='fa fa-trophy'></i><em> ", award, "</em> ·"),
    award == "Honourable Mention" ~ str_c("<img src='/images/ribbon_xs.png' style='height: 1em;'><em> ", award, "</em> ·"),
    TRUE                          ~       ""
  ),
  pdf = ifelse(is.na(pdf), "", str_c(" <span class='publication-extra'>[pdf](", pdf, ")</span>")),
  materials = ifelse(is.na(materials), "", str_c(" · <span class='publication-extra'>[materials](", materials, ")</span>")), 
  ebook = ifelse(is.na(ebook), "", str_c(" · <span class='publication-extra'>[e-book](", ebook, ")</span>")),
  blog = ifelse(is.na(blog), "", str_c(" · <span class='publication-extra'>[blog](", blog, ")</span>")),
  full_talk = ifelse(is.na(full_talk), "", str_c(" · <span class='publication-extra'>[video of full talk](", full_talk, ")</span>")),
  bibtex = ifelse(is.na(bibtex), "", str_c(" · <span class='publication-extra'>[bibtex](", bibtex, ")</span>"))) %>% 
  mutate(citation = str_c("<span class=pub-title>", title, "</span><br>", 
                                 authors_full, "<br>",
                                 venue, "<br>",
                                 award, pdf, materials, ebook, blog, full_talk, bibtex,
                                 sep = " ")
           ) %>%          
  mutate(citation = str_replace(citation, "Ulrik Lyngs", "_Ulrik Lyngs_")) %>%  # make my name bold
  mutate(teaser_video_embed = case_when(
      str_detect(teaser_video_embed, "youtube") ~ glue("<div class='embed-responsive embed-responsive-16by9'><iframe class='embed-responsive-item' src='{teaser_video_embed}' allowfullscreen></iframe></div>"),
      str_detect(teaser_video_embed, "vimeo") ~ glue("<div class='embed-responsive embed-responsive-16by9'><iframe class='embed-responsive-item' src='{teaser_video_embed}' allow='fullscreen'></iframe></div>"),
      is.na(teaser_video_embed) ~ ""
    ))

```

```{r results='asis'}
# draw a table with heading for each year
years <- publications$date %>% year() %>% unique()

for (cur_year in years){
  publications_table %>% 
    filter(year(date) == cur_year) %>% 
    select(type, citation, teaser_video_embed) %>%
    knitr::kable(caption = cur_year, format = "html", table.attr='class="table-responsive"', escape = FALSE) %>%
    print()
} 
```
</div>

<!-- <div class="col-sm-1"></div> -->

<!-- close publications page --> 
</div>