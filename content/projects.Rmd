---
title: Projects
menu: main
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(knitr)
library(here)
library(lubridate)

#### publications #####
publications <- readxl::read_xlsx(here::here("_data", "publications.xlsx"))

#### cv entries #####
cv_entries <- readxl::read_xlsx(here::here("_data", "cv_entries.xlsx"))

#### projects ####
projects <- readxl::read_xlsx(here::here("_data", "projects.xlsx"))

```


```{r results='asis', echo=FALSE}
generate_project_row <- function(id){
  cat("<div class='row project-entries'>")
  
  # add column with teaser image
  teaser_image_path <- projects %>% 
    filter(project_id == id) %>% 
    pull(teaser_image)
  cat(str_c("<div class='col-lg-3 col-md-3'>", 
            "<img src=", teaser_image_path,
            " class='img-fluid featured-work-graphic'/></div>")
      )
   
  # open column with project entries
  cat("<div class='col-lg-9 col-md-9'>") 
  
  # add project title and description
  cur_project <- projects %>% 
    filter(project_id == id) %>% 
    mutate(html = str_c("<h3>", 
                        title, 
                        ifelse(is_current, 
                               " <span class='status-current'>[current]</span>",
                               " <span class='status-past'>[past]</span>"),
                        "</h3>", 
                        description))
  cat(cur_project$html)
  
  # add row with project work
  cat("<div class='row project-work'>")
  project_work <- publications %>% 
    filter(project == id) %>% 
      arrange(desc(year(date))) %>% 
      mutate(html = str_c("<div class='col-sm-4 project-work-entry'>",
                          ifelse(is.na(teaser_video),
                                 str_c("<p class='project-work-entry-title'>[**", title, "**](", pdf, ")<br>",
                                 authors_full, "<br>*", 
                                 venue_abbrev, "*"),
                                 str_c('<div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item featured-work-graphic" src="', teaser_video, '" allowfullscreen></iframe></div>')
                                ),
                          "</div>" )
             )
  cat(project_work$html)
  cat("</div>")
  
  # close project entry column
  cat("</div>") 
  
  # close project row
  cat("</div>")
}

walk(projects$project_id, generate_project_row)

```

